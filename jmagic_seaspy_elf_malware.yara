import "vt"
rule jmagic_seaspy_elf_malware
{
meta:
  description = "J-Magic Malware targeting Juniper Junos Routers"
  author = "Will Thomas, @BushidoToken"
  reference = "https://blog.lumen.com/the-j-magic-show-magic-packets-and-where-to-find-them/"
  hash1 = "5e3c128749f7ae4616a4620e0b53c0e5381724a790bba8314acb502ce7334df2"
  hash2 = "3e0312ce8d0c1e5c192dbb93cac4770a1205c56dc9d02a0510c7e10a15251de5"
  created = "2025-JAN-31"
  TLP = "CLEAR"

strings:
  $str1 = "<Network-Interface> <Listen-Port>" ascii wide nocase
  $str2 = "-DUSE_PCAP -lpcap" ascii wide nocase
  $str3 = "--port <port> [-p]" ascii wide nocase
  $str4 = "cd00r.c" ascii wide nocase
  $str5 = "DLT_JUNIPER_" ascii wide nocase
  
condition:
    all of ($str*)
    and vt.metadata.file_type == vt.FileType.ELF
    and vt.metadata.new_file
}
