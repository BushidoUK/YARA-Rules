rule forbix_vbs_malware_usb
{
  meta:
      description = "Detects Forbix USB malware VBS worm files"
      author = "Will Thomas, @BushidoToken"
      reference = "https://papers.vx-underground.org/papers/Malware%20Defense/Malware%20Analysis%202019/2019-08-24%20-%20Windows%20worms.%20Forbix%20worm%20analysis.pdf"
      creation_date = "3-MAY-2023"
      tlp = "CLEAR"
      hash = "9bf9ea7c52867948ebf98336fd21d58fc859f62760e751663984f4a8cb995c0f"
    
    strings:
        $hex1 = {27 3c 63 6f 64 65 64 20 62 79 20 42 6c 34 63 4b 73 30 63 4b 3e 27} // '<coded by Bl4cKs0cK>'
        $hex2 = {61 63 74 69 76 5f 6e 61 6d 65 20 3d 20 22 53 79 73 69 6e 66 59 68 58 2e 64 62 22} // activ_name = "SysinfYhX.db"
        $hex3 = {70 61 73 73 69 76 5f 6e 61 6d 65 20 3d 20 22 4d 61 6e 75 65 6c 2e 64 6f 63 22} // passiv_name = "Manuel.doc"
        $hex4 = {68 6f 73 74 20 3d 20 22 72 65 61 6c 79 2e 6d 6f 6f 6f 2e 63 6f 6d 22} // host = "realy.mooo.com"
        $hex5 = {69 6e 66 65 63 74 5f 72 65 67 69 73 74 72 65} // infect_registre
        $hex6 = {69 6e 66 65 63 74 5f 6d 61 63 68 69 6e} // infect_machin
        $str1 = "SysinfYhX.db" ascii wide nocase // passive state filename
        $str2 = "SysinfY2X.db" ascii wide nocase // passive state filename
        $str3 = "Manuel.doc" ascii wide nocase // active state filename

    condition:
        all of ($hex*) and any of ($str*)
}
